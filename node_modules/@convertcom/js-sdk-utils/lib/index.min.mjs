/*!
 * Convert JS SDK
 * Version 1.0.0
 * Copyright(c) 2020-2022 Convert Insights, Inc
 * License Apache-2.0
 */
function e(e){return Array.isArray(e)&&e.length>0}function t(e,t,n,r=!1){try{if("object"==typeof e){const n=t.split(".").reduce(((e,t)=>e[t]),e);if(n||r&&(!1===n||0===n))return n}}catch(e){}return void 0!==n?n:null}function n(...e){const t=e=>e&&"object"==typeof e;return e.reduce(((e,r)=>(Object.keys(r).forEach((o=>{const i=e[o],a=r[o];Array.isArray(i)&&Array.isArray(a)?e[o]=[...new Set([...a,...i])]:t(i)&&t(a)?e[o]=n(i,a):e[o]=a})),e)),{})}function r(e){return"object"==typeof e&&null!==e&&Object.keys(e).length>0}const o=(e,t)=>{if(e===t)return!0;if("object"!=typeof e||"object"!=typeof t||null==e||null==t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(const i of n){if(!r.includes(i))return!1;if("function"==typeof e[i]||"function"==typeof t[i]){if(e[i].toString()!=t[i].toString())return!1}else if(!o(e[i],t[i]))return!1}return!0};function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var a,s={exports:{}};a=s,function(){const e=e=>(new TextEncoder).encode(e);function t(t,n){let r,o,i,a,s,u,c,l;for("string"==typeof t&&(t=e(t)),r=3&t.length,o=t.length-r,i=n,s=3432918353,u=461845907,l=0;l<o;)c=255&t[l]|(255&t[++l])<<8|(255&t[++l])<<16|(255&t[++l])<<24,++l,c=(65535&c)*s+(((c>>>16)*s&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(65535&c)*u+(((c>>>16)*u&65535)<<16)&4294967295,i^=c,i=i<<13|i>>>19,a=5*(65535&i)+((5*(i>>>16)&65535)<<16)&4294967295,i=27492+(65535&a)+((58964+(a>>>16)&65535)<<16);switch(c=0,r){case 3:c^=(255&t[l+2])<<16;case 2:c^=(255&t[l+1])<<8;case 1:c^=255&t[l],c=(65535&c)*s+(((c>>>16)*s&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(65535&c)*u+(((c>>>16)*u&65535)<<16)&4294967295,i^=c}return i^=t.length,i^=i>>>16,i=2246822507*(65535&i)+((2246822507*(i>>>16)&65535)<<16)&4294967295,i^=i>>>13,i=3266489909*(65535&i)+((3266489909*(i>>>16)&65535)<<16)&4294967295,i^=i>>>16,i>>>0}const n=t;n.v2=function(t,n){"string"==typeof t&&(t=e(t));let r,o=t.length,i=n^o,a=0;for(;o>=4;)r=255&t[a]|(255&t[++a])<<8|(255&t[++a])<<16|(255&t[++a])<<24,r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16),r^=r>>>24,r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^r,o-=4,++a;switch(o){case 3:i^=(255&t[a+2])<<16;case 2:i^=(255&t[a+1])<<8;case 1:i^=255&t[a],i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)}return i^=i>>>13,i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16),i^=i>>>15,i>>>0},n.v3=t,a.exports=n}();var u,c,l,d=i(s.exports);function f(e,...t){if(t.length){let n=0;return e.replace(/(%?)(%([sj]))/g,((e,r,o,i)=>{if(r)return e;const a=t[n++],s="function"==typeof a?a():a;switch(i){case"s":return String(s);case"j":return JSON.stringify(s)}})).replace("%%","%")}return String(e)}function h(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"")}function p(e,t=9999){return d.v3(String(e),t)}function g(e){if("number"==typeof e)return!0;const t=parseFloat(String(e));return Number.isFinite(t)&&!isNaN(t)}function v(e){if("number"==typeof e)return e;const t=String(e).split(",");return parseFloat("0"==t[0]?String(e).replace(/,/g,"."):String(e).replace(/,/g,""))}class E{static equals(e,t,n){return Array.isArray(e)?this._returnNegationCheck(-1!==e.indexOf(t),n):r(e)?this._returnNegationCheck(-1!==Object.keys(e).indexOf(String(t)),n):(e=String(e),t=String(t),e=e.valueOf().toLowerCase(),t=t.valueOf().toLowerCase(),this._returnNegationCheck(e===t,n))}static less(e,t,n){return typeof(e=g(e)?v(e):e)==typeof(t=g(t)?v(t):t)&&this._returnNegationCheck(e<t,n)}static lessEqual(e,t,n){return typeof(e=g(e)?v(e):e)==typeof(t=g(t)?v(t):t)&&this._returnNegationCheck(e<=t,n)}static contains(e,t,n){return e=String(e),t=String(t),e=e.valueOf().toLowerCase(),0===(t=t.valueOf().toLowerCase()).replace(/^([\s]*)|([\s]*)$/g,"").length?this._returnNegationCheck(!0,n):this._returnNegationCheck(-1!==e.indexOf(t),n)}static isIn(e,t,n=!1,r="|"){const o=String(e).split(r).map((e=>String(e)));"string"==typeof t&&(t=t.split(r)),Array.isArray(t)||(t=[]),t=t.map((e=>String(e).valueOf().toLowerCase()));for(let e=0;e<o.length;e++)if(-1!==t.indexOf(o[e]))return this._returnNegationCheck(!0,n);return this._returnNegationCheck(!1,n)}static startsWith(e,t,n){return e=String(e).valueOf().toLowerCase(),t=String(t).valueOf().toLowerCase(),this._returnNegationCheck(0===e.indexOf(t),n)}static endsWith(e,t,n){return e=String(e).valueOf().toLowerCase(),t=String(t).valueOf().toLowerCase(),this._returnNegationCheck(-1!==e.indexOf(t,e.length-t.length),n)}static regexMatches(e,t,n){e=String(e).valueOf().toLowerCase(),t=String(t).valueOf();const r=new RegExp(t,"i");return this._returnNegationCheck(r.test(e),n)}static _returnNegationCheck(e,t=!1){return t?!e:e}}u=E,E.equalsNumber=u.equals,E.matches=u.equals;class y{constructor(e,t){var n,r,o,i;this._file=e,this._fs=t;try{(null===(r=null===(n=this._fs)||void 0===n?void 0:n.existsSync)||void 0===r?void 0:r.call(n,this._file))||null===(i=null===(o=this._fs)||void 0===o?void 0:o.writeFileSync)||void 0===i||i.call(o,this._file,"{}")}catch(e){console.error(e)}}get(e){var t,n;try{return JSON.parse(null===(n=null===(t=this._fs)||void 0===t?void 0:t.readFileSync)||void 0===n?void 0:n.call(t,this._file))[e]}catch(e){console.error(e)}}set(e,t){var n,r,o,i;try{const a=JSON.parse(null===(r=null===(n=this._fs)||void 0===n?void 0:n.readFileSync)||void 0===r?void 0:r.call(n,this._file));a[e]=t,null===(i=null===(o=this._fs)||void 0===o?void 0:o.writeFileSync)||void 0===i||i.call(o,this._file,JSON.stringify(a))}catch(e){console.error(e)}}delete(e){var t,n,r,o;try{const i=JSON.parse(null===(n=null===(t=this._fs)||void 0===t?void 0:t.readFileSync)||void 0===n?void 0:n.call(t,this._file));delete i[e],null===(o=null===(r=this._fs)||void 0===r?void 0:r.writeFileSync)||void 0===o||o.call(r,this._file,JSON.stringify(i))}catch(e){console.error(e)}}}function O(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError,function(e){e.VARIAION_NOT_DECIDED="convert.com_variation_not_decided"}(c||(c={})),function(e){e.FORCE_MULTIPLE_TRANSACTIONS="forceMultipleTransactions"}(l||(l={}));const S="Unable to perform network request",N="Unsupported response type",T="The user agent successfully queued the data for transfer";var A,R,C,_,m,L,U,w,I,b,D,F,P,k,q,M;!function(e){e.OFF="OFF",e.EU_ONLY="EU ONLY",e.EEA_ONLY="EEA ONLY",e.WORLDWIDE="Worldwide"}(A||(A={})),function(e){e.AUDIENCE="audience",e.LOCATION="location",e.SEGMENT="segment",e.FEATURE="feature",e.GOAL="goal",e.EXPERIENCE="experience",e.VARIATION="variation"}(R||(R={})),function(e){e.ENABLED="enabled",e.DISABLED="disabled"}(C||(C={})),function(e){e.AMOUNT="amount",e.PRODUCTS_COUNT="productsCount",e.TRANSACTION_ID="transactionId"}(_||(_={})),function(e){e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(m||(m={})),function(e){e.LOG="log",e.TRACE="trace",e.DEBUG="debug",e.INFO="info",e.WARN="warn",e.ERROR="error"}(L||(L={})),function(e){e.WEB="web",e.FULLSTACK="fullstack"}(U||(U={})),function(e){e.NO_DATA_FOUND="convert.com_no_data_found",e.NEED_MORE_DATA="convert.com_need_more_data"}(w||(w={})),function(e){e.READY="ready",e.CONFIG_UPDATED="config.updated",e.API_QUEUE_RELEASED="api.queue.released",e.BUCKETING="bucketing",e.CONVERSION="conversion",e.SEGMENTS="segments",e.LOCATION_ACTIVATED="location.activated",e.LOCATION_DEACTIVATED="location.deactivated",e.AUDIENCES="audiences",e.DATA_STORE_QUEUE_RELEASED="datastore.queue.released"}(I||(I={})),function(e){e.RICH_STRUCTURE="richStructure",e.CUSTOM_CODE="customCode",e.DEFAULT_CODE="defaultCode",e.DEFAULT_CODE_MULTIPAGE="defaultCodeMultipage",e.DEFAULT_REDIRECT="defaultRedirect",e.FULLSTACK_FEATURE="fullStackFeature"}(b||(b={})),function(e){e.IE="IE",e.CH="CH",e.FF="FF",e.OP="OP",e.SF="SF",e.EDG="EDG",e.MO="MO",e.NS="NS",e.OTH="OTH"}(D||(D={})),function(e){e.ALLPH="ALLPH",e.IPH="IPH",e.OTHPH="OTHPH",e.ALLTAB="ALLTAB",e.IPAD="IPAD",e.OTHTAB="OTHTAB",e.DESK="DESK",e.OTHDEV="OTHDEV"}(F||(F={})),function(e){e.COUNTRY="country",e.BROWSER="browser",e.DEVICES="devices",e.SOURCE="source",e.CAMPAIGN="campaign",e.VISITOR_TYPE="visitorType",e.CUSTOM_SEGMENTS="customSegments"}(P||(P={})),function(e){e.CAMPAIGN="campaign",e.SEARCH="search",e.REFERRAL="referral",e.DIRECT="direct"}(k||(k={})),function(e){e.NEW="new",e.RETURNING="returning"}(q||(q={}));class x{constructor(e,t,n="appendFileSync"){this._file=e,this._fs=t,this._appendMethod=n}_write(e,...t){return O(this,void 0,void 0,(function*(){var n,r;const o=`${(new Date).toISOString()} [${e.toUpperCase()}]`,i=`${o} ${t.map(JSON.stringify).join(`\n${o} `)}\n`;try{null===(r=null===(n=this._fs)||void 0===n?void 0:n[this._appendMethod])||void 0===r||r.call(n,this._file,i)}catch(e){console.warn(e)}}))}log(...e){return O(this,void 0,void 0,(function*(){yield this._write(L.LOG,...e)}))}info(...e){return O(this,void 0,void 0,(function*(){yield this._write(L.INFO,...e)}))}debug(...e){return O(this,void 0,void 0,(function*(){yield this._write(L.DEBUG,...e)}))}warn(...e){return O(this,void 0,void 0,(function*(){yield this._write(L.WARN,...e)}))}error(...e){return O(this,void 0,void 0,(function*(){yield this._write(L.ERROR,...e)}))}}!function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Processing=102]="Processing",e[e.EarlyHints=103]="EarlyHints",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.MultiStatus=207]="MultiStatus",e[e.AlreadyReported=208]="AlreadyReported",e[e.ImUsed=226]="ImUsed",e[e.MultipleChoices=300]="MultipleChoices",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.Unused=306]="Unused",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.PayloadTooLarge=413]="PayloadTooLarge",e[e.UriTooLong=414]="UriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RangeNotSatisfiable=416]="RangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.ImATeapot=418]="ImATeapot",e[e.MisdirectedRequest=421]="MisdirectedRequest",e[e.UnprocessableEntity=422]="UnprocessableEntity",e[e.Locked=423]="Locked",e[e.FailedDependency=424]="FailedDependency",e[e.TooEarly=425]="TooEarly",e[e.UpgradeRequired=426]="UpgradeRequired",e[e.PreconditionRequired=428]="PreconditionRequired",e[e.TooManyRequests=429]="TooManyRequests",e[e.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",e[e.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported",e[e.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.LoopDetected=508]="LoopDetected",e[e.NotExtended=510]="NotExtended",e[e.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired"}(M||(M={}));const G=e=>!["GET","HEAD","DELETE","TRACE","OPTIONS"].includes(e.toUpperCase()),j=(e,t,n)=>{let o="";return r(e)&&!G(t)&&(o="old-nodejs"!==n.runtime?Object.keys(e).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`)).join("&"):n.queryString.stringify(e)),o?`?${o}`:o},H={request(e){var t;const n=(null===(t=null==e?void 0:e.method)||void 0===t?void 0:t.toUpperCase())||"GET",r=(null==e?void 0:e.path)?e.path.startsWith("/")?e.path:`/${e.path}`:"",o=e.baseURL.endsWith("/")?e.baseURL.slice(0,-1):e.baseURL,i=(null==e?void 0:e.responseType)||"json",a=(()=>{if("undefined"!=typeof window)return{runtime:"browser"};if("function"==typeof fetch)return{runtime:"server-with-fetch"};try{const e=require("url"),t=require("http");return{runtime:"old-nodejs",url:e,http:t,https:require("https"),queryString:require("querystring")}}catch(e){}return{runtime:"unknown"}})();return new Promise(((t,s)=>{if("browser"===a.runtime||"server-with-fetch"===a.runtime){const u={method:n,keepalive:!0};(null==e?void 0:e.headers)&&(u.headers=e.headers),(null==e?void 0:e.data)&&G(n)&&(u.body=JSON.stringify(e.data));const c=`${o}${r}${j(null==e?void 0:e.data,n,a)}`;"post"===n.toLowerCase()&&"undefined"!=typeof navigator&&(null===navigator||void 0===navigator?void 0:navigator.sendBeacon)?navigator.sendBeacon(c,u.body)?t({data:!0,status:M.Ok,statusText:T}):s({message:N}):fetch(c,u).then((e=>O(this,void 0,void 0,(function*(){if(e.status===M.Ok){const n={status:e.status,statusText:e.statusText,headers:e.headers,data:null};switch(i){case"json":n.data=yield e.json();break;case"arraybuffer":n.data=yield e.arrayBuffer();break;case"text":n.data=e;break;default:return void s({message:N})}t(n)}else s({message:e.statusText,status:e.status})})))).catch((e=>{s({message:null==e?void 0:e.message,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText})}))}else if("old-nodejs"===a.runtime){const u=a.url.parse(o);u.port||(u.port="https:"===u.protocol?"443":"80");const c=u.path.endsWith("/")?u.path.slice(0,-1):u.path,l="https:"===u.protocol?a.https:a.http,d=[],f={hostname:u.hostname,path:`${c}${r}${j(null==e?void 0:e.data,n,a)}`,port:u.port,method:n},h=(null==e?void 0:e.data)&&G(n)?JSON.stringify(e.data):null;(null==e?void 0:e.headers)&&(f.headers=e.headers),h&&(f.headers||(f.headers={}),f.headers["Content-Length"]=Buffer.byteLength(h));const p=l.request(f,(e=>{e.on("data",(e=>d.push(e))),e.on("end",(()=>{if(e.statusCode===M.Ok){const n=Buffer.concat(d),r=n.toString(),o={status:e.statusCode,statusText:e.statusMessage,headers:e.headers,data:null};switch(i){case"json":o.data=r?JSON.parse(r):"";break;case"arraybuffer":o.data=null==n?void 0:n.buffer;break;case"text":o.data=e;break;default:return void s({message:N})}t(o)}else s({message:e.statusMessage,status:e.statusCode})}))}));p.on("error",(e=>{const t=e;s({message:null==t?void 0:t.message,status:null==t?void 0:t.code,statusText:null==t?void 0:t.statusText})})),h&&p.write(h),p.end()}else s({message:S})}))}};function B(e,t){switch(t){case"boolean":return"true"===e||"false"!==e&&!!e;case"float":return!0===e?1:!1===e?0:parseFloat(e);case"json":if("object"==typeof e)return e;try{return JSON.parse(e)}catch(t){return String(e)}case"string":return String(e);case"integer":return!0===e?1:!1===e?0:parseInt(e);default:return e}}export{E as Comparisons,y as DataStore,x as FileLogger,H as HttpClient,e as arrayNotEmpty,h as camelCase,B as castType,p as generateHash,g as isNumeric,o as objectDeepEqual,n as objectDeepMerge,t as objectDeepValue,r as objectNotEmpty,j as serialize,f as stringFormat,v as toNumber};
//# sourceMappingURL=index.min.mjs.map
