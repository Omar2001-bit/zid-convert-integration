/*!
 * Convert JS SDK
 * Version 1.0.0
 * Copyright(c) 2020-2022 Convert Insights, Inc
 * License Apache-2.0
 */
"use strict";function e(e){return"object"==typeof e&&null!==e&&Object.keys(e).length>0}const t=(e,r)=>{if(e===r)return!0;if("object"!=typeof e||"object"!=typeof r||null==e||null==r)return!1;const n=Object.keys(e),o=Object.keys(r);if(n.length!=o.length)return!1;for(const i of n){if(!o.includes(i))return!1;if("function"==typeof e[i]||"function"==typeof r[i]){if(e[i].toString()!=r[i].toString())return!1}else if(!t(e[i],r[i]))return!1}return!0};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var n,o={exports:{}};n=o,function(){const e=e=>(new TextEncoder).encode(e);function t(t,r){let n,o,i,s,a,u,c,l;for("string"==typeof t&&(t=e(t)),n=3&t.length,o=t.length-n,i=r,a=3432918353,u=461845907,l=0;l<o;)c=255&t[l]|(255&t[++l])<<8|(255&t[++l])<<16|(255&t[++l])<<24,++l,c=(65535&c)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(65535&c)*u+(((c>>>16)*u&65535)<<16)&4294967295,i^=c,i=i<<13|i>>>19,s=5*(65535&i)+((5*(i>>>16)&65535)<<16)&4294967295,i=27492+(65535&s)+((58964+(s>>>16)&65535)<<16);switch(c=0,n){case 3:c^=(255&t[l+2])<<16;case 2:c^=(255&t[l+1])<<8;case 1:c^=255&t[l],c=(65535&c)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(65535&c)*u+(((c>>>16)*u&65535)<<16)&4294967295,i^=c}return i^=t.length,i^=i>>>16,i=2246822507*(65535&i)+((2246822507*(i>>>16)&65535)<<16)&4294967295,i^=i>>>13,i=3266489909*(65535&i)+((3266489909*(i>>>16)&65535)<<16)&4294967295,i^=i>>>16,i>>>0}const r=t;r.v2=function(t,r){"string"==typeof t&&(t=e(t));let n,o=t.length,i=r^o,s=0;for(;o>=4;)n=255&t[s]|(255&t[++s])<<8|(255&t[++s])<<16|(255&t[++s])<<24,n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16),n^=n>>>24,n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^n,o-=4,++s;switch(o){case 3:i^=(255&t[s+2])<<16;case 2:i^=(255&t[s+1])<<8;case 1:i^=255&t[s],i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)}return i^=i>>>13,i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16),i^=i>>>15,i>>>0},r.v3=t,n.exports=r}();var i,s,a,u=r(o.exports);function c(e){if("number"==typeof e)return!0;const t=parseFloat(String(e));return Number.isFinite(t)&&!isNaN(t)}function l(e){if("number"==typeof e)return e;const t=String(e).split(",");return parseFloat("0"==t[0]?String(e).replace(/,/g,"."):String(e).replace(/,/g,""))}class d{static equals(t,r,n){return Array.isArray(t)?this._returnNegationCheck(-1!==t.indexOf(r),n):e(t)?this._returnNegationCheck(-1!==Object.keys(t).indexOf(String(r)),n):(t=String(t),r=String(r),t=t.valueOf().toLowerCase(),r=r.valueOf().toLowerCase(),this._returnNegationCheck(t===r,n))}static less(e,t,r){return typeof(e=c(e)?l(e):e)==typeof(t=c(t)?l(t):t)&&this._returnNegationCheck(e<t,r)}static lessEqual(e,t,r){return typeof(e=c(e)?l(e):e)==typeof(t=c(t)?l(t):t)&&this._returnNegationCheck(e<=t,r)}static contains(e,t,r){return e=String(e),t=String(t),e=e.valueOf().toLowerCase(),0===(t=t.valueOf().toLowerCase()).replace(/^([\s]*)|([\s]*)$/g,"").length?this._returnNegationCheck(!0,r):this._returnNegationCheck(-1!==e.indexOf(t),r)}static isIn(e,t,r=!1,n="|"){const o=String(e).split(n).map((e=>String(e)));"string"==typeof t&&(t=t.split(n)),Array.isArray(t)||(t=[]),t=t.map((e=>String(e).valueOf().toLowerCase()));for(let e=0;e<o.length;e++)if(-1!==t.indexOf(o[e]))return this._returnNegationCheck(!0,r);return this._returnNegationCheck(!1,r)}static startsWith(e,t,r){return e=String(e).valueOf().toLowerCase(),t=String(t).valueOf().toLowerCase(),this._returnNegationCheck(0===e.indexOf(t),r)}static endsWith(e,t,r){return e=String(e).valueOf().toLowerCase(),t=String(t).valueOf().toLowerCase(),this._returnNegationCheck(-1!==e.indexOf(t,e.length-t.length),r)}static regexMatches(e,t,r){e=String(e).valueOf().toLowerCase(),t=String(t).valueOf();const n=new RegExp(t,"i");return this._returnNegationCheck(n.test(e),r)}static _returnNegationCheck(e,t=!1){return t?!e:e}}i=d,d.equalsNumber=i.equals,d.matches=i.equals;function f(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError,function(e){e.VARIAION_NOT_DECIDED="convert.com_variation_not_decided"}(s||(s={})),function(e){e.FORCE_MULTIPLE_TRANSACTIONS="forceMultipleTransactions"}(a||(a={}));const p="Unable to perform network request",h="Unsupported response type",g="The user agent successfully queued the data for transfer";var E,y,v,O,S,N,T,A,C,R,_,m,L,U,w,I;!function(e){e.OFF="OFF",e.EU_ONLY="EU ONLY",e.EEA_ONLY="EEA ONLY",e.WORLDWIDE="Worldwide"}(E||(E={})),function(e){e.AUDIENCE="audience",e.LOCATION="location",e.SEGMENT="segment",e.FEATURE="feature",e.GOAL="goal",e.EXPERIENCE="experience",e.VARIATION="variation"}(y||(y={})),function(e){e.ENABLED="enabled",e.DISABLED="disabled"}(v||(v={})),function(e){e.AMOUNT="amount",e.PRODUCTS_COUNT="productsCount",e.TRANSACTION_ID="transactionId"}(O||(O={})),function(e){e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(S||(S={})),function(e){e.LOG="log",e.TRACE="trace",e.DEBUG="debug",e.INFO="info",e.WARN="warn",e.ERROR="error"}(N||(N={})),function(e){e.WEB="web",e.FULLSTACK="fullstack"}(T||(T={})),function(e){e.NO_DATA_FOUND="convert.com_no_data_found",e.NEED_MORE_DATA="convert.com_need_more_data"}(A||(A={})),function(e){e.READY="ready",e.CONFIG_UPDATED="config.updated",e.API_QUEUE_RELEASED="api.queue.released",e.BUCKETING="bucketing",e.CONVERSION="conversion",e.SEGMENTS="segments",e.LOCATION_ACTIVATED="location.activated",e.LOCATION_DEACTIVATED="location.deactivated",e.AUDIENCES="audiences",e.DATA_STORE_QUEUE_RELEASED="datastore.queue.released"}(C||(C={})),function(e){e.RICH_STRUCTURE="richStructure",e.CUSTOM_CODE="customCode",e.DEFAULT_CODE="defaultCode",e.DEFAULT_CODE_MULTIPAGE="defaultCodeMultipage",e.DEFAULT_REDIRECT="defaultRedirect",e.FULLSTACK_FEATURE="fullStackFeature"}(R||(R={})),function(e){e.IE="IE",e.CH="CH",e.FF="FF",e.OP="OP",e.SF="SF",e.EDG="EDG",e.MO="MO",e.NS="NS",e.OTH="OTH"}(_||(_={})),function(e){e.ALLPH="ALLPH",e.IPH="IPH",e.OTHPH="OTHPH",e.ALLTAB="ALLTAB",e.IPAD="IPAD",e.OTHTAB="OTHTAB",e.DESK="DESK",e.OTHDEV="OTHDEV"}(m||(m={})),function(e){e.COUNTRY="country",e.BROWSER="browser",e.DEVICES="devices",e.SOURCE="source",e.CAMPAIGN="campaign",e.VISITOR_TYPE="visitorType",e.CUSTOM_SEGMENTS="customSegments"}(L||(L={})),function(e){e.CAMPAIGN="campaign",e.SEARCH="search",e.REFERRAL="referral",e.DIRECT="direct"}(U||(U={})),function(e){e.NEW="new",e.RETURNING="returning"}(w||(w={}));!function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Processing=102]="Processing",e[e.EarlyHints=103]="EarlyHints",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.MultiStatus=207]="MultiStatus",e[e.AlreadyReported=208]="AlreadyReported",e[e.ImUsed=226]="ImUsed",e[e.MultipleChoices=300]="MultipleChoices",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.Unused=306]="Unused",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.PayloadTooLarge=413]="PayloadTooLarge",e[e.UriTooLong=414]="UriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RangeNotSatisfiable=416]="RangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.ImATeapot=418]="ImATeapot",e[e.MisdirectedRequest=421]="MisdirectedRequest",e[e.UnprocessableEntity=422]="UnprocessableEntity",e[e.Locked=423]="Locked",e[e.FailedDependency=424]="FailedDependency",e[e.TooEarly=425]="TooEarly",e[e.UpgradeRequired=426]="UpgradeRequired",e[e.PreconditionRequired=428]="PreconditionRequired",e[e.TooManyRequests=429]="TooManyRequests",e[e.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",e[e.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported",e[e.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.LoopDetected=508]="LoopDetected",e[e.NotExtended=510]="NotExtended",e[e.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired"}(I||(I={}));const b=e=>!["GET","HEAD","DELETE","TRACE","OPTIONS"].includes(e.toUpperCase()),D=(t,r,n)=>{let o="";return e(t)&&!b(r)&&(o="old-nodejs"!==n.runtime?Object.keys(t).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`)).join("&"):n.queryString.stringify(t)),o?`?${o}`:o},F={request(e){var t;const r=(null===(t=null==e?void 0:e.method)||void 0===t?void 0:t.toUpperCase())||"GET",n=(null==e?void 0:e.path)?e.path.startsWith("/")?e.path:`/${e.path}`:"",o=e.baseURL.endsWith("/")?e.baseURL.slice(0,-1):e.baseURL,i=(null==e?void 0:e.responseType)||"json",s=(()=>{if("undefined"!=typeof window)return{runtime:"browser"};if("function"==typeof fetch)return{runtime:"server-with-fetch"};try{const e=require("url"),t=require("http");return{runtime:"old-nodejs",url:e,http:t,https:require("https"),queryString:require("querystring")}}catch(e){}return{runtime:"unknown"}})();return new Promise(((t,a)=>{if("browser"===s.runtime||"server-with-fetch"===s.runtime){const u={method:r,keepalive:!0};(null==e?void 0:e.headers)&&(u.headers=e.headers),(null==e?void 0:e.data)&&b(r)&&(u.body=JSON.stringify(e.data));const c=`${o}${n}${D(null==e?void 0:e.data,r,s)}`;"post"===r.toLowerCase()&&"undefined"!=typeof navigator&&(null===navigator||void 0===navigator?void 0:navigator.sendBeacon)?navigator.sendBeacon(c,u.body)?t({data:!0,status:I.Ok,statusText:g}):a({message:h}):fetch(c,u).then((e=>f(this,void 0,void 0,(function*(){if(e.status===I.Ok){const r={status:e.status,statusText:e.statusText,headers:e.headers,data:null};switch(i){case"json":r.data=yield e.json();break;case"arraybuffer":r.data=yield e.arrayBuffer();break;case"text":r.data=e;break;default:return void a({message:h})}t(r)}else a({message:e.statusText,status:e.status})})))).catch((e=>{a({message:null==e?void 0:e.message,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText})}))}else if("old-nodejs"===s.runtime){const u=s.url.parse(o);u.port||(u.port="https:"===u.protocol?"443":"80");const c=u.path.endsWith("/")?u.path.slice(0,-1):u.path,l="https:"===u.protocol?s.https:s.http,d=[],f={hostname:u.hostname,path:`${c}${n}${D(null==e?void 0:e.data,r,s)}`,port:u.port,method:r},p=(null==e?void 0:e.data)&&b(r)?JSON.stringify(e.data):null;(null==e?void 0:e.headers)&&(f.headers=e.headers),p&&(f.headers||(f.headers={}),f.headers["Content-Length"]=Buffer.byteLength(p));const g=l.request(f,(e=>{e.on("data",(e=>d.push(e))),e.on("end",(()=>{if(e.statusCode===I.Ok){const r=Buffer.concat(d),n=r.toString(),o={status:e.statusCode,statusText:e.statusMessage,headers:e.headers,data:null};switch(i){case"json":o.data=n?JSON.parse(n):"";break;case"arraybuffer":o.data=null==r?void 0:r.buffer;break;case"text":o.data=e;break;default:return void a({message:h})}t(o)}else a({message:e.statusMessage,status:e.statusCode})}))}));g.on("error",(e=>{const t=e;a({message:null==t?void 0:t.message,status:null==t?void 0:t.code,statusText:null==t?void 0:t.statusText})})),p&&g.write(p),g.end()}else a({message:p})}))}};exports.Comparisons=d,exports.DataStore=class{constructor(e,t){var r,n,o,i;this._file=e,this._fs=t;try{(null===(n=null===(r=this._fs)||void 0===r?void 0:r.existsSync)||void 0===n?void 0:n.call(r,this._file))||null===(i=null===(o=this._fs)||void 0===o?void 0:o.writeFileSync)||void 0===i||i.call(o,this._file,"{}")}catch(e){console.error(e)}}get(e){var t,r;try{return JSON.parse(null===(r=null===(t=this._fs)||void 0===t?void 0:t.readFileSync)||void 0===r?void 0:r.call(t,this._file))[e]}catch(e){console.error(e)}}set(e,t){var r,n,o,i;try{const s=JSON.parse(null===(n=null===(r=this._fs)||void 0===r?void 0:r.readFileSync)||void 0===n?void 0:n.call(r,this._file));s[e]=t,null===(i=null===(o=this._fs)||void 0===o?void 0:o.writeFileSync)||void 0===i||i.call(o,this._file,JSON.stringify(s))}catch(e){console.error(e)}}delete(e){var t,r,n,o;try{const i=JSON.parse(null===(r=null===(t=this._fs)||void 0===t?void 0:t.readFileSync)||void 0===r?void 0:r.call(t,this._file));delete i[e],null===(o=null===(n=this._fs)||void 0===n?void 0:n.writeFileSync)||void 0===o||o.call(n,this._file,JSON.stringify(i))}catch(e){console.error(e)}}},exports.FileLogger=class{constructor(e,t,r="appendFileSync"){this._file=e,this._fs=t,this._appendMethod=r}_write(e,...t){return f(this,void 0,void 0,(function*(){var r,n;const o=`${(new Date).toISOString()} [${e.toUpperCase()}]`,i=`${o} ${t.map(JSON.stringify).join(`\n${o} `)}\n`;try{null===(n=null===(r=this._fs)||void 0===r?void 0:r[this._appendMethod])||void 0===n||n.call(r,this._file,i)}catch(e){console.warn(e)}}))}log(...e){return f(this,void 0,void 0,(function*(){yield this._write(N.LOG,...e)}))}info(...e){return f(this,void 0,void 0,(function*(){yield this._write(N.INFO,...e)}))}debug(...e){return f(this,void 0,void 0,(function*(){yield this._write(N.DEBUG,...e)}))}warn(...e){return f(this,void 0,void 0,(function*(){yield this._write(N.WARN,...e)}))}error(...e){return f(this,void 0,void 0,(function*(){yield this._write(N.ERROR,...e)}))}},exports.HttpClient=F,exports.arrayNotEmpty=function(e){return Array.isArray(e)&&e.length>0},exports.camelCase=function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"")},exports.castType=function(e,t){switch(t){case"boolean":return"true"===e||"false"!==e&&!!e;case"float":return!0===e?1:!1===e?0:parseFloat(e);case"json":if("object"==typeof e)return e;try{return JSON.parse(e)}catch(t){return String(e)}case"string":return String(e);case"integer":return!0===e?1:!1===e?0:parseInt(e);default:return e}},exports.generateHash=function(e,t=9999){return u.v3(String(e),t)},exports.isNumeric=c,exports.objectDeepEqual=t,exports.objectDeepMerge=function e(...t){const r=e=>e&&"object"==typeof e;return t.reduce(((t,n)=>(Object.keys(n).forEach((o=>{const i=t[o],s=n[o];Array.isArray(i)&&Array.isArray(s)?t[o]=[...new Set([...s,...i])]:r(i)&&r(s)?t[o]=e(i,s):t[o]=s})),t)),{})},exports.objectDeepValue=function(e,t,r,n=!1){try{if("object"==typeof e){const r=t.split(".").reduce(((e,t)=>e[t]),e);if(r||n&&(!1===r||0===r))return r}}catch(e){}return void 0!==r?r:null},exports.objectNotEmpty=e,exports.serialize=D,exports.stringFormat=function(e,...t){if(t.length){let r=0;return e.replace(/(%?)(%([sj]))/g,((e,n,o,i)=>{if(n)return e;const s=t[r++],a="function"==typeof s?s():s;switch(i){case"s":return String(a);case"j":return JSON.stringify(a)}})).replace("%%","%")}return String(e)},exports.toNumber=l;
//# sourceMappingURL=index.min.js.map
