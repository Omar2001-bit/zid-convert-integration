import { BucketingHash, BucketingAllocation, Config } from './types';
import { LogManagerInterface } from './logger';

/*!
 * Convert JS SDK
 * Version 1.0.0
 * Copyright(c) 2020 Convert Insights, Inc
 * License Apache-2.0
 */

interface BucketingManagerInterface {
    selectBucket(buckets: Record<string, number>, value: number, redistribute?: number): string | null;
    getValueVisitorBased(visitorId: string, options?: BucketingHash): number;
    getBucketForVisitor(buckets: Record<string, number>, visitorId: string, options?: BucketingHash): BucketingAllocation | null;
}

/*!
 * Convert JS SDK
 * Version 1.0.0
 * Copyright(c) 2020 Convert Insights, Inc
 * License Apache-2.0
 */

/**
 * Provides logic for bucketing for specific visitor (by visitorId) or randomly
 * @category Modules
 * @constructor
 * @implements {BucketingManagerInterface}
 */
declare class BucketingManager implements BucketingManagerInterface {
    private readonly _max_traffic;
    private readonly _hash_seed;
    private _loggerManager;
    /**
     * @param {Config=} config
     * @param {Object=} dependencies
     * @param {LogManagerInterface=} dependencies.loggerManager
     */
    constructor(config?: Config, { loggerManager }?: {
        loggerManager?: LogManagerInterface;
    });
    /**
     * Select variation based on its percentages and value provided
     * @param {object} buckets Key-value object with variations IDs as keys and percentages as values
     * @param {number} value A bucket value
     * @param {number=} redistribute Defaults to '0'
     * @return {string | null}
     */
    selectBucket(buckets: Record<string, number>, value: number, redistribute?: number): string | null;
    /**
     * Get a value based on hash from Visitor id to use for bucket selecting
     * @param {string} visitorId
     * @param {BucketingHash=} options
     * @param {number=} [options.seed=]
     * @param {string=} [options.experienceId=]
     * @return {number}
     */
    getValueVisitorBased(visitorId: string, options?: BucketingHash): number;
    /**
     * Get a bucket for the visitor
     * @param {object} buckets Key-value object with variations IDs as keys and percentages as values
     * @param {string} visitorId
     * @param {BucketingHash=} options
     * @param {number=} [options.redistribute=0]
     * @param {number=} [options.seed=]
     * @param {string=} [options.experienceId=]
     * @return {BucketingAllocation | null}
     */
    getBucketForVisitor(buckets: Record<string, number>, visitorId: string, options?: BucketingHash): BucketingAllocation | null;
}

export { BucketingManager, type BucketingManagerInterface };
